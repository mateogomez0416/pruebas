(()=>{"use strict";const e=e=>{const t=`; ${document.cookie}`.split(`; ${e}=`);if(2===t.length)return t.pop().split(";").shift()},t=(e,t)=>{if(e){const t=document.querySelector(e);if(t)return t}if(t)for(let e=0;e<t.length;e++){const o=document.querySelector(t[e]);if(o)return o}return null},o=(e,t)=>{t.parentNode.insertBefore(e,t.nextSibling)},n=e=>{const t=Object.keys(e),o={};for(let n=0;n<Object.keys(e).length;n++)e[t[n]]&&(o[t[n]]=e[t[n]]);return o},r=Boolean(navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i))?"mobile":"desktop",i={offcorssonline:{paymentButtonSelector:"a.buy-in-page-button",qtyCounterSelector:'.buy-in-page-quantity[productindex="0"]'},addi:{paymentButtonSelector:"a.buy-button.buy-button-ref",qtyCounterSelector:"input.qtd.pull-left"}},a=(e,t)=>"legacy"===e?i[t]?.[r]?.paymentButtonSelector??i[t]?.paymentButtonSelector:"io"===e?"div.vtex-add-to-cart-button-0-x-buttonDataContainer":void 0,c={macId:()=>e("VtexRCMacIdv7"),sessionId:()=>e("VtexRCSessionIdv7")};function d(e,t){return async()=>{const o=l(),n=await o("/api/checkout/pub/orderForm?refreshOutdatedData=true","POST",null,"json"),r=n.success?n.payload:{};return{orderFormId:r.orderFormId,allySlug:e,merchantDomain:location.origin,selectedItem:t,orderDetails:r}}}function l(){return async(e,t,o,n)=>{const r=(i=e,(a=c)?(Object.keys(a).forEach((function(e){i=i.replace(new RegExp(`{{${e}}}`,"g"),a[e]())})),i):i);var i,a;const d={json:"application/json",text:"application/text",form:"application/x-www-form-urlencoded"},l={};return d[n]&&(l["Content-Type"]=d[n]),await fetch(`${location.origin}${r}`,{method:t,headers:l,...o?{body:(e=>"json"===n?JSON.stringify(e):e)(o)}:{}}).then((async e=>{if(!e.ok)return{success:!1,status:e.status,statusText:await e.text()};const t=e?.headers?.get("Content-Type")??"";return{success:!0,...{...t.includes("json")?{payload:await e.json()}:{},...t.includes("text")?{payload:await e.text()}:{}}}})).catch((e=>e))}}async function s(e,t,o,n,r){return await fetch(`${e}/api/checkout/pub/orderForm/${t}/items/update`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({noSplitItem:!0,orderItems:[{id:o,quantity:0,seller:n,index:r,hasBundleItems:!1}]})}).then((e=>e.json())).catch((e=>null))}!function(){const e=new Date,c="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>{const t=+e;return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})),u=window?.__RUNTIME__?.accountId?"io":"legacy",m=(window.dataLayer&&(window?.dataLayer[0]?.pageCategory||(window?.dataLayer?.find((e=>e.pageCategory))||{}).pageCategory))??(()=>{const e=window.location.pathname;return"/"===e?"Home":e.endsWith("/p")||e.includes("/p?")?"Product":""})(),g=document.querySelector('script[data-id][data-name="vtexAddiWidget"]'),h={allySlug:g.getAttribute("data-ally-slug"),IOevents:{productClick:"vtex:productClick",productView:"vtex:productView"}},p={showBanner:!1,bannerId:"",htmlElementRef:null},f={productPrice:null,customCSS:{},htmlElementRef:null,genericSelectorsRef:[".product__price",".precioProducto",".precio",".plugin-preco",".productPrice",".price-box",".priceProduct",".seletor-sku"]},y={htmlElementRef:null,genericSelectorsRef:[a(u,h.allySlug)]};let b=null;const w=()=>{A()},S=()=>{const e=window.skuJson||{},t=e.skus&&e.skus.find((e=>e.available)),o=window.decimalDigits||0;f.productPrice=t.bestPrice/10**o,I(),D()},k=e=>{const{selectedSku:t,sku:o}=e?.product||{},n=t??o,r=n.sellers&&n.sellers.find((e=>e?.commertialOffer?.AvailableQuantity)),i=window.decimalDigits||0;f.productPrice=r.commertialOffer.Price/10**i,I(),D()},A=()=>{p.showBanner="true"===g.getAttribute("data-show-banner"),p.bannerId=g.getAttribute("data-banner-id"),p.htmlElementRef=g.getAttribute("data-banner-element-reference"),p.showBanner&&function(e,{bannerId:t,htmlElementRef:n}){const r=document.querySelector("home-banner");r&&r.remove();const i=document.createElement("home-banner");t&&(i.setAttribute("ally-slug",e),i.setAttribute("banner-id",t)),o(i,n)}(h.allySlug,p)},I=()=>{if(!f?.htmlElementRef){const e=g.getAttribute("data-element-reference"),o=t(e,f.genericSelectorsRef);if(!o)return void console.log(`[ADDI - Awareness Widget] No Element Node was found for the selector ${e}`);f.htmlElementRef=o}f?.customCSS||(f.customCSS=(e=>{const t={borderColor:e.getAttribute("widget-border-color"),borderRadius:e.getAttribute("widget-border-radius"),fontColor:e.getAttribute("widget-font-color"),fontFamily:e.getAttribute("widget-font-family"),fontSize:e.getAttribute("widget-font-size"),badgeBackgroundColor:e.getAttribute("widget-badge-background-color"),infoBackgroundColor:e.getAttribute("widget-info-background-color"),iconType:e.getAttribute("widget-addi-icon-type"),iconSize:e.getAttribute("widget-addi-icon-size"),margin:e.getAttribute("widget-margin")},o={backgroundColor:e.getAttribute("modal-background-color"),fontColor:e.getAttribute("modal-font-color"),fontFamily:e.getAttribute("modal-font-family"),priceColor:e.getAttribute("modal-price-color"),badgeBackgroundColor:e.getAttribute("modal-badge-background-color"),badgeFontColor:e.getAttribute("modal-badge-font-color"),badgeBorderRadius:e.getAttribute("modal-badge-border-radius"),cardColor:e.getAttribute("modal-card-color"),buttonBorderColor:e.getAttribute("modal-button-border-color"),buttonBorderRadius:e.getAttribute("modal-button-border-radius"),buttonBackgroundColor:e.getAttribute("modal-button-background-color"),buttonFontColor:e.getAttribute("modal-button-font-color")};return JSON.stringify({widget:n(t),modal:n(o)})})(g)),E(h.allySlug,f)},E=(t,{productPrice:n,customCSS:r,htmlElementRef:i})=>{const a=document.querySelector("addi-product-widget");n&&a&&a.remove();const c=a??document.createElement("addi-product-widget");c.setAttribute("ally-slug",t),c.setAttribute("price",n),c.setAttribute("country","co"),c.setAttribute("custom-widget-styles",JSON.stringify(r)),c.addEventListener("onWidgetClickedEvent",(()=>{b&&b("PDP_SCRIPT.WIDGET_CLICKED")})),o(c,i);const d=new Date;b&&b("PDP_SCRIPT.WIDGET_INSERTED",{onScriptInitTimeMs:e.getTime(),onWdgInsertedTimeMs:d.getTime(),onWdgInsertedDurationMs:d.getTime()-e.getTime()}),setTimeout((()=>{const t=document.querySelector("addi-product-widget");t||(console.log("Widget was NOT created"),b&&b("PDP_SCRIPT.WIDGET_NOT_INSERTED",{onScriptInitTimeMs:e.getTime(),widgetInsertionFailedTimeMs:d.getTime()})),t?.shadowRoot?.hasChildNodes()||b&&b("PDP_SCRIPT.WIDGET_NOT_DISPLAYED",{onScriptInitTimeMs:e.getTime(),widgetInsertionFailedTimeMs:d.getTime()})}),7e3)},D=()=>{if(!y?.htmlElementRef){const e=g.getAttribute("data-checkout-element-reference"),o=t(e,y.genericSelectorsRef);if(!o)return void console.log(`[ADDI - Expedited Widget] No Element Node was found for the selector ${e}`);y.htmlElementRef=o,"DIV"!==o.tagName&&(y.htmlElementRef=o.parentElement)}T(h.allySlug,y)},T=(e,{htmlElementRef:t})=>{const n=document.querySelector("addi-one-click-checkout");n&&n.remove();const a=document.createElement("addi-one-click-checkout");a.setAttribute("ally-slug",e),a.addEventListener("checkoutStarted",(t=>{!async function(e,t){const o=e?.detail?.selectedItem;if(!o)return console.log("[ADDI] There is no way no notify the selected item"),o("ErrorUnexpected",null);const n=location.origin,a=await async function(e,t){const o=(e=>{const t=i[e]?.[r]??i[e];return()=>{const e=document.querySelectorAll(t.paymentButtonSelector),o=document.querySelectorAll(t.paymentButtonSelectorBack);if(!e?.length)return{};let n="";for(const t of e){const e=t.getAttribute("href");e&&e.startsWith("/checkout/")&&(n=e)}for(const e of o){const t=e.getAttribute("href");t&&t.startsWith("/checkout/")&&(n=t)}if(!n)return{};const r=new URL(`${location.origin}${n}`);return{sku:r?.searchParams?.get("sku"),seller:r?.searchParams?.get("seller"),qty:t.qtyCounterSelector?document.querySelector(t.qtyCounterSelector)?.value:"1"}}})(e);if(!o)return;const n=await async function(e){return await fetch(`${e}/api/checkout/pub/orderForm?refreshOutdatedData=true`,{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>e.json()))}(t),{sku:a,qty:c,seller:d}=o();return[a,c,d,n].every((e=>!!e))?{sku:a,qty:c,seller:d,orderForm:n}:void 0}(t,n);if(!a)return console.log("[ADDI] Is not possible to read the selected SKU, quantity or seller. The checkout can't start"),o("ErrorNoSkuOrQuantity",null);const{sku:c,qty:u,seller:m,orderForm:g}=a,{orderFormId:h}=g;await async function(e,t){return await fetch(`${e}/api/checkout/pub/orderForm/${t}/messages/clear`,{method:"POST",headers:{"Content-Type":"application/json"},body:"{}"}).then((e=>e.json())).catch((e=>null))}(n,h);const p=g?.items?.findIndex((e=>e.id===c));if(p>=0){const e=await s(n,h,c,m,p);if(!e)return console.log("[ADDI] Something went wrong removing the current item from the cart"),o("ErrorRemovingItem",null);if(e.messages.length)return console.log("[ADDI] Something is not right after trying to remove the item. Please check the messages"),o("ErrorRemovingItem",null)}const f=await async function(e,t,o,n,r){return await fetch(`${e}/api/checkout/pub/orderForm/${t}/items`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderItems:[{id:o,quantity:n,seller:r}]})}).then((e=>e.json())).catch((e=>null))}(n,h,c,u,m);if(!f)return console.log("[ADDI] Something went wrong adding the item to the cart"),o("ErrorAddingItem",null);if(f.messages.some((e=>"withoutStock"===e.code))){const e=f?.items?.findIndex((e=>e.id===c));return await s(n,h,c,m,e),console.log("[ADDI] Selected item out of stock"),o("ErrorItemOutOfStock",null)}if(f.messages.length)return console.log("[ADDI] Something is not right after trying to add the item. Please check the messages"),o("ErrorAddingItem",null);o("Ok",{getCheckoutData:d(t,function(e){const t=window.skuJson.skus.find((t=>t.sku===+e));return t?{id:t.sku,description:t.skuname,value:t.fullSellingPrice,imageUrl:t.image}:null}(c)),apiCaller:l()})}(t,e)})),o(a,t)};var C,v;!function(){if("Home"===m){const e=document.createElement("script");e.type="module",e.src="https://cdn.addi.com/home-banner-widget/prod/v1/home-banner-widget.esm.js",document.head.append(e)}if("Product"===m){const e=document.createElement("script");e.type="module",e.src="https://cdn.addi.com/product-details-widget/prod/v1/product-details-widget.esm.js",document.head.append(e),I()}}(),(()=>{if("Product"===m){if("legacy"===u)return(()=>{try{const e=new Vtex.JSEvents.Listener("batchBuyListener",S);skuEventDispatcher&&skuEventDispatcher.addListener(skuDataReceivedEventName,e)}catch(e){console.log("[ADDI] Something when wrong trying to subscribe a Vtex Batch Listener ",e)}window.addEventListener("skuSelected.vtex",S),document.addEventListener("readystatechange",(e=>{"complete"===e.target.readyState&&S()}))})();if("io"===u)return void window.addEventListener("message",(e=>{const t=e.data;t.eventName===h.IOevents.productView&&k(t)}))}document.addEventListener("readystatechange",(e=>{"complete"===e.target.readyState&&w()}))})(),"Product"===m&&(C=c,v=h.allySlug,b=(e="",t={})=>(({source:e,id:t,title:o,params:n,channel:r,allySlug:i})=>{const a={id:t,title:o,params:{executedAt:(new Date).toString(),...n},properties:{channel:r,allySlug:i}};return(async(e,t,o={},n={})=>{const r=`${e}${t}`;return n={method:"POST",headers:{"content-type":"application/json"},...n},await fetch(r,{...n,body:o}).then((e=>e.json())).catch((e=>e))})("https://logger.addi.com",`/api/events/${e}`,JSON.stringify(a))})({id:C,title:e,params:t,source:"ALLY_INTEGRATION_PRODUCT",channel:"E_COMMERCE_VTEX",allySlug:v}).then())}()})();